# DuckTodo API 接口文档目录

本文档汇总了 DuckTodo 后端服务的所有 API 接口文档。

## 基础说明

- **服务根路径**: `/api`
- **数据格式**: JSON
- **字符编码**: UTF-8
- **日期格式**: `yyyy-MM-dd` (如 `2024-01-01`) 或 `yyyy-MM-dd HH:mm:ss` (视具体字段而定)
- **鉴权方式**:
    - 大部分接口需要鉴权（Header 中携带 Token）。
    - 支持两种鉴权 Header：
        1. **Bearer Token**: `Authorization: Bearer <jwt_token>` 或 `token: <jwt_token>`
        2. **AK/SK**: `access_token: <AK>` 与 `secret_Token: <SK>`

## 通用返回格式

所有接口（除极少数特殊接口外）均返回统一的 JSON 结构：

```json
{
  "success": true,      // 请求是否成功
  "code": 200,          // 业务状态码 (200=成功, 400=参数错误或权限不足, 401=未认证, 404=未找到, 500=内部错误)
  "message": "操作成功", // 提示信息
  "data": {},           // 具体的业务数据对象，结构视具体接口而定
  "timestamp": 1704074400000 // 服务器时间戳
}
```

## 文档列表与接口详情

### 1. [base接口说明文档.md](./base接口说明文档.md) (Base 基础模块)
> 系统健康检查、用户登录、注册、登出等公开接口（大部分无需鉴权）。

| 序号 | 接口名称 | 方法 | 路径 | 描述 |
| :--- | :--- | :--- | :--- | :--- |
| 1 | 系统健康检查 | GET | `/api/base/health` | 检查系统运行状态及依赖服务连通性。 |
| 2 | 登录 | POST | `/api/base/login` | 用户登录，获取 JWT Token。 |
| 3 | 注册 | POST | `/api/base/register` | 注册新用户，并自动登录。 |

### 2. [user接口说明文档.md](./user接口说明文档.md) (User 用户模块)
> 用户个人信息查询、修改、密码修改、头像上传、AK/SK 管理。

| 序号 | 接口名称 | 方法 | 路径 | 描述 |
| :--- | :--- | :--- | :--- | :--- |
| 1 | 获取当前用户信息 | GET | `/api/user/me` | 获取当前登录用户的详细信息。 |
| 2 | 根据 ID 获取用户信息 | GET | `/api/user/{userId}` | 查询指定用户ID的公开信息。 |
| 3 | 更新我的资料 | PUT | `/api/user/me` | 修改当前用户的个人信息（不支持修改用户名）。 |
| 4 | 获取 AK/SK | GET | `/api/user/me/access-keys` | 获取当前用户的 API 访问密钥。 |
| 5 | 更新 AK/SK | PUT | `/api/user/me/access-keys` | 更新当前用户的 API 访问密钥。 |
| 6 | 删除 AK/SK | DELETE | `/api/user/me/access-keys` | 删除（清空）当前用户的 API 访问密钥。 |

### 3. [team接口说明文档.md](./team接口说明文档.md) (Team 团队模块)
> 团队创建、删除、成员管理、邀请处理、团队信息更新。

| 序号 | 接口名称 | 方法 | 路径 | 描述 |
| :--- | :--- | :--- | :--- | :--- |
| 1 | 创建团队 | POST | `/api/teams` | 创建团队，初始化任务族与成员关系，并可邀请成员。 |
| 2 | 邀请成员加入团队 | POST | `/api/teams/{teamId}/members` | 邀请成员加入团队（支持 manager/member 角色）。 |
| 3 | 删除团队 | DELETE | `/api/teams/{teamId}` | 删除团队及其关联数据。仅 Owner 可操作。 |
| 4 | 退出团队 | DELETE | `/api/teams/{teamId}/members/me` | 当前用户退出团队（Owner 不可退出）。 |
| 5 | 删除成员 | DELETE | `/api/teams/{teamId}/members/{userId}` | 将指定成员移出团队（仅 Owner/Manager 可操作）。 |
| 6 | 更新团队信息 | PUT | `/api/teams` | 修改团队名称、描述、状态。 |
| 7 | 接受/拒绝邀请 | PUT | `/api/teams/{teamId}/invites/me/{action}` | 处理团队加入邀请 (action: accept/reject)。 |
| 8 | 修改成员角色 | PUT | `/api/teams/{teamId}/members/{userId}/role` | 修改成员角色（仅 Owner/Manager 可操作）。 |
| 9 | 获取我的团队列表 | GET | `/api/teams/me` | 查询本人已加入（Normal）的团队列表。 |
| 10 | 获取团队成员列表 | GET | `/api/teams/{teamId}/members` | 分页查询团队成员。 |

### 4. [taskgroup接口说明文档.md](./taskgroup接口说明文档.md) (TaskGroup 任务族模块)
> 私有任务族的创建、更新、删除及排序管理。

| 序号 | 接口名称 | 方法 | 路径 | 描述 |
| :--- | :--- | :--- | :--- | :--- |
| 1 | 创建私有任务族 | POST | `/api/taskgroups` | 创建私有任务族（仅当前登录用户）。 |
| 2 | 更新私有任务族 | PUT | `/api/taskgroups` | 更新私有任务族信息（仅创建者）。 |
| 3 | 删除私有任务族 | DELETE | `/api/taskgroups/{taskGroupId}` | 删除私有任务族及其关联的所有数据。仅创建者可操作。 |
| 4 | 交换任务族排序 | PUT | `/api/taskgroups/order` | 交换个人两个任务族的排序。 |
| 5 | 修改任务族颜色 | PUT | `/api/taskgroups/{taskGroupId}/members/me/color` | 修改当前用户对该任务族的颜色标记。 |
| 6 | 修改任务族别名 | PUT | `/api/taskgroups/{taskGroupId}/members/me/alias` | 修改当前用户对该任务族的别名。 |
| 7 | 获取我的任务族列表 | GET | `/api/taskgroups/me` | 列出当前用户相关任务族（按关系排序）。 |

### 5. [task接口说明文档.md](./task接口说明文档.md) (Task 任务模块)
> 任务的增删改查、子任务管理、协助者、附件、审计日志。

| 序号 | 接口名称 | 方法 | 路径 | 描述 |
| :--- | :--- | :--- | :--- | :--- |
| 1 | 创建任务 | POST | `/api/tasks` | 创建一个新的任务，可同时设置协助者、子任务。 |
| 2 | 更新任务 | PUT | `/api/tasks` | 更新任务的基础信息。 |
| 3 | 删除任务 | DELETE | `/api/tasks/{taskId}` | 删除任务及其关联的所有数据。 |
| 4 | 获取任务详情 | GET | `/api/tasks/{taskId}` | 获取任务的完整详情。 |
| 5 | 获取任务族任务列表（分页） | GET | `/api/tasks/taskgroups/{taskGroupId}/tasks/page` | 分页查询指定任务族下的任务。 |
| 6 | 获取任务族任务列表（不分页） | GET | `/api/tasks/taskgroups/{taskGroupId}/tasks` | 列出指定任务族下的所有任务。 |
| 7 | 获取我的任务列表（分页） | GET | `/api/tasks/me/page` | 分页查询与当前用户相关（拥有或协助）的任务。 |
| 8 | 获取我的任务列表（不分页） | GET | `/api/tasks/me` | 列出与当前用户相关的所有任务。 |
| 9 | 获取我的日程视图 | GET | `/api/tasks/me/schedule` | 按年/月查询我的任务。 |
| 10 | 添加子任务 | POST | `/api/tasks/children` | 为已有任务添加子任务。 |
| 11 | 更新子任务 | PUT | `/api/tasks/{taskId}/children` | 更新子任务信息。 |
| 12 | 删除子任务 | DELETE | `/api/tasks/{taskId}/children/{childTaskId}` | 删除指定的子任务。 |
| 13 | 子任务排序 | PUT | `/api/tasks/{taskId}/children/order` | 调整子任务的顺序。 |
| 14 | 获取子任务列表 | GET | `/api/tasks/{taskId}/children` | 获取指定任务的子任务列表。 |
| 15 | 添加协助者 | POST | `/api/tasks/{taskId}/followers` | 为任务添加协助者。 |
| 16 | 删除协助者 | DELETE | `/api/tasks/{taskId}/followers/{taskHelperId}` | 移除协助者。 |
| 17 | 上传附件 | POST | `/api/tasks/{taskId}/files` | 上传任务附件。 |
| 18 | 删除附件 | DELETE | `/api/tasks/{taskId}/files/{taskFileId}` | 删除指定附件。 |
| 19 | 获取附件列表 | GET | `/api/tasks/{taskId}/files` | 获取任务的有效附件列表。 |
| 20 | 获取审计日志 | GET | `/api/tasks/{taskId}/audits` | 获取任务的操作审计日志。 |

### 6. [statistics接口说明文档.md](./statistics接口说明文档.md) (Statistics 统计模块)
> 个人与团队维度的任务数据统计、趋势图、燃尽图等。

| 序号 | 接口名称 | 方法 | 路径 | 描述 |
| :--- | :--- | :--- | :--- | :--- |
| 1 | 个人概览统计（加入） | GET | `/api/stats/me/overview/joined` | 统计加入的团队/任务族数量。 |
| 2 | 个人概览统计（进行中） | GET | `/api/stats/me/overview/in_progress` | 统计进行中任务/子任务数量。 |
| 3 | 个人概览统计（本周完成） | GET | `/api/stats/me/overview/completed/week` | 统计本周完成任务数。 |
| 4 | 个人概览统计（本月完成） | GET | `/api/stats/me/overview/completed/month` | 统计本月完成任务数。 |
| 5 | 个人概览统计（累计完成） | GET | `/api/stats/me/overview/completed/total` | 统计累计完成任务数。 |
| 6 | 个人概览统计（逾期） | GET | `/api/stats/me/overview/overdue` | 统计逾期任务数（分级）。 |
| 7 | 个人负载趋势 | GET | `/api/stats/me/trend/load` | 统计近 N 天进行中任务数量趋势。 |
| 8 | 个人任务趋势 | GET | `/api/stats/me/trend/tasks` | 统计任务创建/完成趋势。 |
| 9 | 个人完成率趋势 | GET | `/api/stats/me/trend/completion` | 统计任务完成率趋势。 |
| 10 | 个人活跃度趋势 | GET | `/api/stats/me/trend/activity` | 统计每日操作活跃度。 |
| 11 | 个人优先级分布 | GET | `/api/stats/me/distribution/priority` | 统计任务优先级分布。 |
| 12 | 个人状态分布 | GET | `/api/stats/me/distribution/status` | 统计任务状态分布。 |
| 13 | 个人任务到期预报 | GET | `/api/stats/me/expiration/forecast` | 统计未来任务到期情况。 |
| 14 | 个人逾期统计（区间） | GET | `/api/stats/me/overdue` | 统计指定区间的逾期任务。 |
| 15 | 个人平均响应时间 | GET | `/api/stats/me/mttr` | 统计任务平均完成耗时 (MTTR)。 |
| 16 | 团队概览统计 | GET | `/api/stats/teams/{teamId}/overview` | 汇总团队任务总量及分布。 |
| 17 | 团队任务分布 | GET | `/api/stats/teams/{teamId}/distribution` | 统计团队任务状态/优先级分布。 |
| 18 | 团队成员负载统计 | GET | `/api/stats/teams/{teamId}/workload` | 统计团队成员负载情况。 |
| 19 | 团队燃尽图 | GET | `/api/stats/teams/{teamId}/burndown` | 统计团队任务燃尽情况。 |
| 20 | 团队逾期统计（详细） | GET | `/api/stats/teams/{teamId}/overdue` | 统计团队逾期详情。 |
| 21 | 团队活跃度趋势 | GET | `/api/stats/teams/{teamId}/trend/activity` | 统计团队活跃度趋势。 |
| 22 | 团队图谱摘要 | GET | `/api/stats/teams/{teamId}/graph/summary` | 统计团队任务图谱节点/边信息。 |

### 7. [dingtalkconfig接口说明文档.md](./dingtalkconfig接口说明文档.md) (DingTalkConfig 模块)
> 钉钉机器人配置的增删改查。

| 序号 | 接口名称 | 方法 | 路径 | 描述 |
| :--- | :--- | :--- | :--- | :--- |
| 1 | 获取配置列表 | GET | `/api/dingtalk-robot-configs` | 获取当前用户的配置列表。 |
| 2 | 添加配置 | POST | `/api/dingtalk-robot-configs` | 添加新的钉钉机器人配置。 |
| 3 | 更改配置 | PUT | `/api/dingtalk-robot-configs/{robotId}` | 更新钉钉机器人配置。 |
| 4 | 删除配置 | DELETE | `/api/dingtalk-robot-configs/{robotId}` | 删除钉钉机器人配置。 |
| 5 | 获取单个配置 | GET | `/api/dingtalk-robot-configs/{robotId}` | 获取单个配置详情。 |

### 8. [llmconfig接口说明文档.md](./llmconfig接口说明文档.md) (LlmConfig 模块)
> LLM（大模型）配置的增删改查。

| 序号 | 接口名称 | 方法 | 路径 | 描述 |
| :--- | :--- | :--- | :--- | :--- |
| 1 | 获取配置列表 | GET | `/api/llm-configs` | 获取当前用户的 LLM 配置列表。 |
| 2 | 添加配置 | POST | `/api/llm-configs` | 添加新的 LLM 配置。 |
| 3 | 更改配置 | PUT | `/api/llm-configs/{configId}` | 更新 LLM 配置。 |
| 4 | 删除配置 | DELETE | `/api/llm-configs/{configId}` | 删除 LLM 配置。 |
| 5 | 获取单个配置 | GET | `/api/llm-configs/{configId}` | 获取单个配置详情。 |
